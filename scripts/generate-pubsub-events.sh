#!/bin/sh
# Generate pubsub.Event interface for all structs in a file.

input=$1
output="${1%.go}.gen.go"

echo "// Code generated by generate-pubsub-events.sh; DO NOT EDIT." >${output}
echo $(grep "^package " ${input}) >>${output}
echo "" >>${output}

for v in $(grep "^type .* struct {" ${input} | cut -f2 -d " "); do
	echo "func (e ${v}) EventTopic() string {
	return \"${v}\"
}
" >>${output}
done
